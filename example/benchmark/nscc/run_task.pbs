#!/bin/bash
#PBS -N elixir_benchmark
#PBS -P 11002535
#PBS -l select=1:ncpus=128:ngpus=4
#PBS -l walltime=08:00:00
#PBS -q normal
#PBS -o /home/users/nus/e0496101/hhc/output/
#PBS -e /home/users/nus/e0496101/hhc/error/

workspace=~/hhc/Elixir

module load cuda miniconda3 gcc/9.5.0-nscc cudnn/11.6-8.4.0.27 nccl/11.6-2.12.10-1

conda activate elx-ben

cd $workspace

export PYTHONPATH=$PWD
export CUDA_VISIBLE_DEVICES=0,1,2,3

cd ./example/benchmark/nscc

bash benchmark.sh

wait
